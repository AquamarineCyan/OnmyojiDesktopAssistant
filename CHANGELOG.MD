# Change Log

## 最近更新

### 新功能

- 新增`创建桌面快捷方式`功能
- 适配新版桌面版，详情见`README.md`

### 优化

- 适配`逢魔之原`契灵
- 适配`斗技`新UI

### 修复

- 修复识别阈值被临时更改引起的阵容锁定状态识别异常的问题

## v2.0.7 - 2025-10-19

### 新功能

- 新增设置项：`交互模式`：`前台`/`后台`，以及`前台运行前置游戏窗口`和`后台运行禁止系统休眠`

### 优化

- 适配新版契灵结契（非连续使用式盘）
- 优化日志记录定位

### 修复

- 修复`个人突破`勋章数识别错误的问题
- 修复`结界突破`可能的截图区域偏移问题

## v2.0.6 - 2025-09-13

### 优化

- `限时活动`提升单次上限至9999次

### 修复

-  修复`限时活动`在`获得奖励`的条件下不同步完成情况的问题

## v2.0.5 - 2025-09-07

### 优化

- 前后台截图统一使用窗口客户区
- 日志模块使用自动轮换
- 统一坐标体系（相对于客户端）

## v2.0.4 - 2025-07-26

### 新功能

- 新增全局任务管理
- 游戏窗口管理可视化

### 优化

- 优化键盘监听功能的退出方式
- 优化全局任务管理
- 降低识别阈值，有效提升`六道之门`复杂场景下的识别效果
- 更新`新版本`和`更新记录`的界面设计，支持`MarkDown`格式
- 主窗口关闭时同步关闭子窗口

### 修复

- 修复新引入的后台截图失败的问题
- 尝试修复更新后重启失败的问题

## v2.0.3 - 2025-06-15

### 新功能

- 添加日服窗口信息
- 适配日服的`单人御魂副本`

### 优化

- 提高配置文件读取的优先级
- 为设置项`游戏服务器`添加重启提示

### 修复

- 更新`个人探索`素材
- 修复后台鼠标无法拖动的问题
- 修复潜在的鼠标异常停止的问题
- 修复`个人探索`在后台滑动失效的问题

## v2.0.2 - 2025-03-26

### 新功能

- `词条分析`，分析御魂的有效词条数

### 优化

- 优化`限时活动`功能，适配大部分爬塔活动
- 区分警告和错误信息
- 同步`日轮副本`和`永生之海副本`关于战斗中场景的识别逻辑
- `组队御魂副本`支持识别`御魂上限`弹窗
- 适配新版契灵结契流程
- `个人突破`支持首轮不主动失败

### 修复

- 修复`御魂副本`战斗中场景在部分战斗主题下识别异常导致无法结束战斗的问题

## v2.0.1 - 2025-02-27

### 新功能

- `系统通知`支持启用和关闭

### 优化

- 优化资源检查流程
- 适配活动「花间取牌」

## v2.0.0 - 2025-02-05

### 破坏性更新

- 更改项目名称

### 新功能

- 完善后台交互，包括截图、点击、键盘事件
- 支持在任务结束后提示接到的悬赏封印数量
- `斗技自动上阵`支持`段位上升`和`周奖励`界面
- 新增`单人日轮副本`，优化组队御魂选择逻辑
- 支持任务异常时自动记录异常
- 新增`后台交互`选项

### 优化

- `御魂`副本支持多种战斗主题和战斗场景「鎏金圣域」
- 提供多个镜像源，优先从延迟最低的镜像源开始更新
- 优化程序初始化流程
- 移除测试功能`掉落统计beta`
- 任务结束支持提示信息
- 调整功能描述的实现方法
- 完善异常捕获机制
- 优化文字识别的返回值和日志记录
- 修改软件图标的加载方式
- 调整素材导入方式
- `assets.json`文件支持(0,0,0,0)格式，表示整个游戏窗口
- 调整`斗技自动上阵`单局结束后同时触发周奖励和段位上升时的顺序
- 适配活动「宴间试炼」
- 更新通用素材 `失败` `单人挑战`
- `阴阳寮突破`点击区域居中，添加重试机制
- 优化`契灵`功能的交互逻辑

### 修复

- 修复在现世第二天切换到`阴阳寮突破`功能时，默认次数不准确的问题
- 修复`六道之门`副本`鏖战之屿`场景在部分设备上识别不准确导致的卡住问题
- 修复`契灵`探查无法挑战的问题

## v1.8.11 - 2024-12-31

### 新功能

- 新增`兵藏秘境`副本

### 优化

- 使用异常捕获的方式，更快结束当前任务
- `鬼兵演武`(`guibingyanwu`)相关素材迁移至`英杰试炼`(`yingjieshilian`)
- 更新镜像站地址
- 适配活动「街道巡逻-捣乱的小妖」

### 修复

- 修复版本号判断问题
- 修复`六道之门速刷`不能正常使用双倍奖励的问题
- 修复`鬼兵演武`结算无buff卡住的问题

## v1.8.10 - 2024-12-04

### 优化

- 移除测试用变量
- 调整`契灵`抓捕逻辑，仅支持镇墓兽
- `阴阳寮突破`支持进度90%提前结束任务
- 适配活动「酣斗之巅」

### 修复

- 修复`道馆突破`等待自动进入时卡住的问题
- 修复`阴阳寮突破`进度条检测异常的问题
- 修复版本号判断问题

## v1.8.9 - 2024-11-06

### 新功能

- 新增快捷键控制`开始/停止`

### 优化

- 简化配置的引用方法
- 优化更新包异常时的处理，添加提示信息
- 调整`阴阳寮突破`的最后一排坐标
- 重构`更新`模块，默认镜像源下载，支持手动下载，从本地更新包更新
- 移除无用代码
- 适配活动「鬼宿试炼」

### 修复

- 尝试修复部分情况下接受`悬赏封印`卡住主任务的问题
- 修复默认配置项无法被重置的问题

## v1.8.8 - 2024-10-09

### 优化

- 添加帮助文档
- 更新镜像站地址
- 适配活动「巡查缉捕」

## v1.8.7 - 2024-09-11

### 新功能

- 新增源赖光升级副本`鬼兵演武`

### 优化

- 适配活动「登龙见四野」

### 修复

- 修复`文字识别`功能异常导致部分功能卡住的问题
- 修复`限时活动`次数不准确的问题
- 临时修复网络问题导致的初始化功能异常

## v1.8.6 - 2024-08-14

### 优化

- 适配活动「焰火巡游」
- 结算界面点击优先选取靠近鼠标一侧

## v1.8.5 - 2024-07-17

### 新功能

- 新增`Rectangle`矩形类，为`文字识别`选框提供接口

### 优化

- 调整`次数`选项框的大小
- 调整`斗技`功能「战」的识别率
- 适配活动「深入岛心」

## v1.8.4 - 2024-06-19

### 优化

- 没有`ocr(文字识别)`文件夹资源时，切换`ghproxy`更新方式，将在下次更新时自动下载资源
- 新增`斗技自动上阵`功能，适合不变朕挂机阵容
- 调整`设置-下载线路`优先级
- 适配活动「幽厢探秘」

### 修复

- 修复`六道之门`鼠标点击异常的问题

## v1.8.3 - 2024-06-04

### 优化

- 更新`普通召唤`位置坐标

### 修复

- 尝试修复不同屏幕比例的`强制缩放`

## v1.8.2 - 2024-05-22

### 破坏性变更

- 调整底层交互
- 统一图像&文字识别接口

### 优化

- 添加2k屏幕的窗口默认比例
- 适配活动「蜃影重楼」

### 修复

- 修复`强制缩放`后初始化判定失败的问题
- 修复窗口判定异常导致不能`强制缩放`的问题

## v1.8.1 - 2024-04-03

### 新功能

- `限时活动`支持御魂上限提醒

### 优化

- 重构图像识别，提高识别速度
- 适配活动「退治海妖」

### 修复

- 修复`限时活动`第一次识别不到主界面就会卡死的问题
- 修复`阴阳寮突破`检测当前页仅剩一个能够进攻的结界时异常循环的问题

## v1.8.0 - 2024-03-03

### 破坏性变更

- 调整资源 `fight` -> `global`

### 新功能

- 新增 `结界突破` 的 `保级` 功能
- 新增 `六道之门` 椒图速刷，需要椒图+4柔风+不打星之子的阵容

### 优化

- 设置项现在支持实时更新
- 调整部分线程为定时任务
- 适配活动「循音试炼」

## v1.7.13 - 2024-02-06

### 新功能

- 新增`文字识别`使用方法
- 自动更新游戏窗口，仅限单开
- 新增`用户自定义素材`功能，位于`/data/myresource`，使用方法见`README.md`的`使用方法`

### 优化

- 启动用户文件夹`data`
- 使用脚本迁移用户数据
- 适配活动「冰海异客」
- 优化`普通召唤`的实现逻辑

### 修复

- 修复`简约主题`下的`道馆突破`无法准备的问题
- 修复`单人御魂`结算后点击过快导致打开其他界面的问题

## v1.7.12 - 2024-01-09

### 新功能

- 新增`契灵`的`鸣契石`使用

### 优化

- 调整`契灵`默认选项为`结契`
- 自动获取`更新记录`
- 适配活动「藏金阁楼」

## v1.7.11 - 2023-12-18

### 新功能

- 新增觉醒副本

### 优化

- 移除更新升级过程中的`任意键`
- 减少图像轮询产生的日志
- 裁切悬赏封印的部分素材，提高识别率

### Bug 修复

- 修复重启脚本残留的问题

## v1.7.10 - 2023-11-14

### 新功能

- 新增正态分布判断，点击位置更居中
- 新增设置项`记忆上次所选功能`
- 新增设置项`界面风格`

### 优化

- 为限时活动添加异常处理
- 调整UI
- 加快GUI启动速度
- 适配活动「花境试炼」，寮友提供体服素材
- 优化更新升级的重启体验

### Bug 修复

- 修复重启按钮失败的问题
- 修复用户配置失效的问题
- 修复御魂副本结束识别过快的问题
- 修复镜像站失效的问题

## v1.7.9 - 2023-10-18

### 新功能

- 添加新版本提示弹窗

### 优化

- 缩短阴阳寮突破的结界间距坐标
- 优化配置模块
- 下载路线添加`gitee`，更稳定的访问
- 优化打包细节
- 为`random_sleep`添加默认参数
- 移除`百面归一`功能
- 适配活动「演武练习」

### Bug 修复

- 修复配置项下载线路`ghproxy`未生效的问题

## v1.7.8 - 2023-09-20

### 新功能

- 新增 鼠标滚轮操作
- 新增 阴阳寮突破翻页功能

### 优化

- 移除多余资源
- 为悬赏封印的点击事件添加超时时间
- 使用固定点位依次点击5个契灵小图标
- 调整21时后寮突破的默认次数为100次
- 判断当前寮突是否有效
- 适配活动「微光之守」

## v1.7.7 - 2023-08-23

### 优化

- 优化日志记录速度
- 更新基类函数
- 道馆突破适配怀旧&简约主题
- 适配活动「真火切磋」

## v1.7.6 - 2023-07-26

### 新功能

- 新增开始/停止功能

### 优化

- 添加自动打包环境
- 优化日志操作
- 优化悬赏封印识别速度
- 统一截图保存路径
- 适配新版召唤界面
- 适配活动「守缘合战」

### Bug 修复

- 修复更新完新版本，重复识别更新包的问题
- 修复业原火重复识别结束界面的问题
- 修复个人突破无法刷新的问题
- 修复悬赏封印卡住主任务的问题

## v1.7.5 - 2023-06-28

### 新功能

- 新增单人探索测试功能
- 新增契灵-探查测试功能

### 优化

- 日志保存的时间精度
- 添加程序复用属性
- 优化配置文件
- 调整 `app` 属性
- 修改项目结构
- 简化组队御魂副本的场景提示
- 调整调试信息的时间显示
- 完善异常提醒
- 移除主界面信息显示的行数限制
- 优化契灵结契流程
- 调整设置项-`更新模式`和`下载路线`
- 适配活动「森间试炼」

### Bug 修复

- 活动卡顿引起的判定异常问题
- 修复单人御魂副本非正常结束的问题
- 修复单人探索副本无法运行的问题
- 修复单人探索副本结束后无法正确识别宝箱和妖气的问题
- 修复结界突破识别异常的问题

## v1.7.4 - 2023-05-24

### 新功能

- 添加手动重启按钮

### 优化

- 组队/单人御魂副本任务
- 修改工具类函数的导入形式
- 更新下载显示
- 御魂副本支持素材复用
- 组队永生之海副本，支持新版结算
- 结果判断逻辑，防止手快提前进入结算逻辑
- 重启函数
- 适配活动「宴场维和」

### Bug 修复

- 关闭悬赏可能导致进程卡住问题
- 设置-更新模式未生效的问题
- 组队御魂中场景判定问题
- 业原火无法挑战的问题

## v1.7.3 - 2023-04-26

### 新功能

- 更新自动重启
- 新增`Coor`坐标类
- 添加御魂副本测试项，使用新方法识别
- 新增悬赏封印关闭选项，降低程序运行功耗（需重启）
- 添加单人御魂副本测试功能

### 优化

- 默认启用镜像源下载
- 完善资源检查
- 测试用log文件夹测试完成后自动删除
- 更新「妖塔燃战」限时活动资源
- 设置界面

### Bug 修复

- 镜像源启用失败的问题
- 匹配更新包空路径的问题
- 资源检测线程问题
- `requirements.txt` 环境问题([#3](https://github.com/AquamarineCyan/Onmyoji_Python/issues/3))
- 图像文件后缀补全失败的问题

## v1.7.2 - 2023-03-26

### 破坏性更新

- 移除`update.json`，移除旧版本更新方式

### 新功能

- 对中文路径的提示
- 日志自动清理（30天）
- 更新记录
- 对组队御魂副本时司机可能出现的bug提示
- 御魂掉落统计beta

### 优化

- 配置文件的读取优先级
- 游戏窗口检测

### Bug 修复

- 潜存在的路径转义问题
- 神罚素材不全问题
- 日志文件概率乱码的问题
- utf-8异常乱码问题

## v1.7.1 - 2023-02-19

### 新功能

- 镜像下载源
- 对部分素材的路径检查

### 优化

- 任务完成的表现形式
- 系统通知保留至通知栏
- 适配神罚副本

## v1.7.0 - 2023-01-18

### 破坏性更新

- 该版本为1.7测试版
- 资源文件夹由`pic`更新为`resource`，尝试兼容旧资源文件夹

### 新功能

- 配置文件及设置

### 优化

- 悬赏封印处理方式并添加设置项

## v1.6.8 - 2022-12-24

### 优化

- 适配签到2000天奖励「鎏金圣域」

### Bug 修复

- 匹配道馆突破场景失败的提示

## v1.6.7 - 2022-11-20

### 新功能

- 系统通知
- 创建poetry打包环境

### 优化

- 项目结构
- 部分素材
- 重构日志工具包
- 删除run.bat启动方式（已实现自动获取管理员权限）
- 去除无更新时的系统通知
- 寮突破21时无限突破的提示
- 开启环境自动检测
- 回退限时活动至周年庆版本前    

## v1.6.6 - 2022-10-16

### 破坏性更新

- 更换检查更新方式，旧版代码将于`v1.7.0`作废

### 新功能

- 自动下载更新包
- 强制缩放([#1](https://github.com/AquamarineCyan/Onmyoji_Python/issues/1))
- 强制缩放及弹窗提示

### 优化

- 素材
- 限时活动单次上线
- 窗口大小匹配提示
- 寮突破次数选择上限

## v1.6.5 - 2022-09-21

### 新功能

- 管理员运行提示

### 优化

- 周年庆活动

## v1.6.4 - 2022-07-24

### 新功能

- 悬赏封印
- 检查更新

### Bug 修复

- UI

## v1.6.3 - 2022-06-22

### 新功能

- 环境文件requirements.txt
- 清理日志
- 限时活动
- 组队日轮副本

### 优化

- 召唤功能结束
- 截图功能
- 窗口信息显示方式
- 个人突破刷新逻辑

### Bug 修复

- 因呱太入侵导致的图像错位
- 更换pathlib库引发的错误

## v1.6.2 - 2022-05-22

### 新功能

- 业原火副本
- 道馆突破观战功能

### 优化

- 功能列表顺序

### Bug 修复

- 初次使用无日志时写入报错

## v1.6.1 - 2022-04-25

### 新功能
- UI界面色彩显示
- 组队永生之海副本
- 更新窗口信息功能

### 优化

- 代码冗余

## v1.6 - 2022-04-10

### 新功能

- UI界面
- 日志模块

### 优化

- 代码逻辑

## v1.5 - 2022-03-15

### 新功能

- 百鬼夜行功能
- 道馆突破功能
- 御灵功能
- 绘卷查分功能
- 错误和异常判断处理
- 部分注释说明
- 输出界面的色彩直观表达
- 功能选择的输入稳定性

### 优化
- 普通召唤的判定逻辑
- 个人结界与寮结界的相互识别跳转
- 文件处理的逻辑
- 适配键入回车默认选择
- 适配新版结算速度

## v1.4 - 2022-02-26

### 新功能

- 个人结界功能

### 优化

- 图片素材存储

## v1.3 - 2022-02-01

### 新功能

- 寮突破功能

### 优化

- 函数调用
- 御魂组队情况

## v1.2 - 2022-01-24

### 新功能

- 组队御魂功能

## v1.1

### 新功能

- 普通召唤功能
# Onmyoji_Python

解放双手，介意勿扰

## 前言

使用阴阳师桌面版[提供NGA下载地址](https://nga.178.com/read.php?tid=29661629)

暂不支持多开，~~环境检测时哪个窗口在最前默认该窗口~~

模拟器没适配，~~理论上只需要获取窗口句柄，改一下窗口大小等参数~~

## 功能

1. 组队御魂副本
    - 仅适用于组队中
    - 适配司机/打手
2. 组队永生之海副本
    - 仅适用于组队中
    - 适配司机/打手
3. 寮突破
    - 锁定阵容，从上至下进攻
4. 个人突破
    - 3胜刷新
    - 锁定阵容
5. 百鬼夜行
    - 清票
    - 截图，默认启用
6. 道馆突破
    - 等待系统进入/手动挑战/正在进行中
    - 挂机阵容
7. 御灵副本
8. 普通召唤
    - 清票/狗粮

## 使用方法

1. **推荐** 前往 [releases](https://github.com/AquamarineCyan/Onmyoji_Python/releases) 下载压缩包，解压，使用管理员启动 **Onmyoji_Python**
   （鼠标点击事件需要管理员权限）
2. （已弃用）下载源码，安装环境 `pip install -r requirements.txt` ， `cmd` 运行 `python Onmyoji_Python.exe` ，依旧需要管理员权限

### run.bat

run.bat 可快速以管理员身份运行主程序

**推荐**为主程序添加管理员身份，一劳永逸

1. 使用方法1，双击启动
2. （已弃用）使用方法2，修改 run.bat 内容 `start Onmyoji_Python.exe` 为 `start Onmyoji_Python.py` 后双击启动

## UI

- 功能模块
    - 1.组队御魂副本
    - 2.组队永生之海副本
    - 3.寮突破
    - 4.个人突破
    - 5.百鬼夜行
    - 6.道馆突破
    - 7.御灵副本
    - 8.普通召唤
- 更新窗口信息
    - 手动更新窗口信息，适合窗口移动，或双开

## 待实现

- UI
    - [x] 更新窗口信息（手动）
    - [x] log
    - [x] 更新日志
    - [ ] 全局跳转
    - [ ] 功能分类
    - [ ] 式神录一键预设队伍
    - [ ] 自定义设置
- 组队御魂副本&组队永生之海副本
    - [x] 司机挑战
    - [ ] 手动情况下第一次自动邀请/受邀
    - [ ] 加成开启/关闭
- 寮突破
    - [ ] 翻页
- 个人突破
    - [x] 统计勋章数
    - [ ] 保级
- 百鬼夜行
    - [x] 截图
    - [ ] 邀请好友
- 道馆突破
    - [ ] 观战诸位
    - [ ] 2次挑战机会 ~~手动选择2次功能~~

## Tips

**请自行合理使用，所产生的一切后果自负**

请确认您是使用管理员权限打开本程序，否则部分功能会失效（鼠标点击事件调用系统底层）

使用过程中（环境检测后），~~请不要移动游戏窗口，会导致点击位置错误~~ 移动窗口后，点击`更新窗口信息`即可

